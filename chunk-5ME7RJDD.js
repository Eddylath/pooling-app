import{a as U,c as X,d as Z}from"./chunk-H2LTBQJG.js";import{a as P,b as O,c as A,d as G,e as j,f as W,h as H,i as q,j as Y,n as z,o as J,p as K,q as Q}from"./chunk-EJ6KLYKD.js";import{Ea as m,Ga as F,Ha as I,Ia as T,Ja as w,Ka as i,La as t,Ma as p,Na as v,Oa as g,Pa as s,Qa as S,Ra as n,Sa as c,Ta as B,Ua as M,Va as N,W as f,X as _,Xa as x,Ya as R,jb as V,kb as L,lb as D,na as a,ra as k,va as E,za as b}from"./chunk-6CPTGQ4B.js";var C=o=>({error:o});function ee(o,r){if(o&1){let e=v();i(0,"tr")(1,"td")(2,"input",15),N("ngModelChange",function(d){f(e);let u=s(4);return M(u.selectedRide,d)||(u.selectedRide=d),_(d)}),t()(),i(3,"td"),n(4),t(),i(5,"td"),n(6),t(),i(7,"td"),n(8),t(),i(9,"td"),n(10),t(),i(11,"td"),n(12),t(),i(13,"td"),n(14),t(),i(15,"td"),n(16),t(),i(17,"td"),n(18),t()()}if(o&2){let e=r.$implicit,l=s(4);a(2),B("ngModel",l.selectedRide),m("value",e.id),a(2),c(e.empId),a(2),c(e.vehicleType),a(2),c(e.vehicleNumber),a(2),c(e.seatsAvailable),a(2),c(e.seatsAvailable-e.alreadyBookedBy.length),a(2),c(e.rideTime),a(2),c(e.pickupLocation),a(2),c(e.dropLocation)}}function te(o,r){if(o&1){let e=v();i(0,"div",12)(1,"div",14)(2,"table")(3,"tr"),p(4,"th"),i(5,"th"),n(6,"Provider emp ID"),t(),i(7,"th"),n(8,"Vehicle type"),t(),i(9,"th"),n(10,"Vehicle number"),t(),i(11,"th"),n(12,"Total seats"),t(),i(13,"th"),n(14,"Seats available"),t(),i(15,"th"),n(16,"Ride time"),t(),i(17,"th"),n(18,"Pickup location"),t(),i(19,"th"),n(20,"drop location"),t()(),T(21,ee,19,10,"tr",null,I),t()(),i(23,"button",11),g("click",function(){f(e);let d=s(3);return _(d.onSubmit())}),n(24,"Book ride"),t()()}if(o&2){let e=s(3);a(21),w(e.ridesToShow),a(2),m("disabled",!e.selectedRide)}}function ie(o,r){if(o&1&&b(0,te,25,1,"div",13),o&2){let e=s(2),l=S(4);m("ngIf",e.ridesToShow.length)("ngIfElse",l)}}function ne(o,r){if(o&1){let e=v();i(0,"div",3)(1,"form",4)(2,"div",5)(3,"div",6)(4,"label"),n(5,"Employee Id"),t(),p(6,"input",7),t(),i(7,"div",6)(8,"label"),n(9,"Ride time"),t(),p(10,"input",8),t(),i(11,"div",6)(12,"label"),n(13,"Pickup location"),t(),p(14,"input",9),t(),i(15,"div",6)(16,"label"),n(17,"Drop location"),t(),p(18,"input",10),t(),i(19,"div",6),p(20,"label"),i(21,"button",11),g("click",function(){f(e);let d=s();return _(d.onSearch())}),n(22,"Search"),t()()()(),b(23,ie,1,2,"div",12),t()}if(o&2){let e=s();a(),m("formGroup",e.bookRideForm),a(5),m("ngClass",x(7,C,e.isFieldInvalid("empId"))),a(4),m("ngClass",x(9,C,e.isFieldInvalid("rideTime"))),a(4),m("ngClass",x(11,C,e.isFieldInvalid("dropLocation"))),a(4),m("ngClass",x(13,C,e.isFieldInvalid("dropLocation"))),a(3),m("disabled",e.isSearchDisabled()),a(2),F(e.showTable?23:-1)}}function oe(o,r){if(o&1){let e=v();i(0,"div",12)(1,"h1"),n(2,"Your ride has been booked successfully"),t(),i(3,"button",16),g("click",function(){f(e);let d=s();return _(d.addMore())}),n(4,"Add more"),t()()}}function re(o,r){o&1&&(i(0,"div",17)(1,"h3"),n(2,"No data to show"),t()())}var $=class o{constructor(r,e){this.fb=r;this.service=e;this.initiateForm()}bookRideForm;selectedRide=0;formOpen=!0;showTable=!1;ridesToShow=[];ngOnint(){}initiateForm(){this.bookRideForm=this.fb.group({empId:["",O.required],rideTime:[""],pickupLocation:[""],dropLocation:[""]},{validator:[U("empId"),X("rideTime"),Z("pickupLocation","dropLocation")]})}isSearchDisabled(){return this.bookRideForm.invalid}isFieldInvalid(r){return this.bookRideForm.get(r)?.touched&&this.bookRideForm.get(r)?.errors}addMore(){this.formOpen=!0,this.showTable=!1,this.initiateForm()}onSearch(){this.ridesToShow=this.service.availableRides.filter(r=>{if(r.seatsAvailable===r.alreadyBookedBy.length||r.empId===this.bookRideForm.value.empId||r.alreadyBookedBy.includes(this.bookRideForm.value.empId)||this.bookRideForm.value.pickupLocation&&r.pickupLocation!==this.bookRideForm.value.pickupLocation||this.bookRideForm.value.dropLocation&&r.dropLocation!==this.bookRideForm.value.dropLocation)return!1;if(!this.bookRideForm.value.rideTime)return!0;let e=r.rideTime.split(":"),l=Number(e[0]),d=Number(e[1]),u=this.bookRideForm.value.rideTime.split(":"),h=Number(u[0]),y=Number(u[1]);return!(l-h>1||h-l>1||l-h===1&&d-y>0||l-h===-1&&d-y<0)}),this.showTable=!0}onSubmit(){this.formOpen=!1,this.service.availableRides[this.selectedRide-1].alreadyBookedBy.push(this.bookRideForm.value.empId),this.selectedRide=0}static \u0275fac=function(e){return new(e||o)(k(z),k(Q))};static \u0275cmp=E({type:o,selectors:[["app-book-ride"]],decls:5,vars:2,consts:[["SaveMessage",""],["NoDataPresent",""],["class","flex",4,"ngIf","ngIfElse"],[1,"flex"],[3,"formGroup"],[1,"form-wrapper","flex","f-column"],[1,"flex","f-gap-1","f-x-baseline"],["type","text","formControlName","empId",1,"input",3,"ngClass"],["type","time","formControlName","rideTime",1,"input",3,"ngClass"],["type","text","formControlName","pickupLocation","placeholder","Office/Bellandur etc",1,"input",3,"ngClass"],["type","text","formControlName","dropLocation","placeholder","Office/Bellandur etc",1,"input",3,"ngClass"],[1,"primary-button",3,"click","disabled"],[1,"flex","f-column","f-x-center"],["class","flex f-column f-x-center",4,"ngIf","ngIfElse"],[1,"table-container"],["type","radio","name","ride",3,"ngModelChange","ngModel","value"],[1,"primary-button",3,"click"],[1,"no-data","flex","f-x-center"]],template:function(e,l){if(e&1&&b(0,ne,24,15,"div",2)(1,oe,5,0,"ng-template",null,0,R)(3,re,3,0,"ng-template",null,1,R),e&2){let d=S(2);m("ngIf",l.formOpen)("ngIfElse",d)}},dependencies:[D,V,L,K,W,P,H,A,G,q,Y,J,j],styles:["label[_ngcontent-%COMP%]{flex:1;text-align:end}input[_ngcontent-%COMP%]{flex:1}.form-wrapper[_ngcontent-%COMP%]{margin-top:25px;width:25vw}.no-data[_ngcontent-%COMP%]{height:350px;width:50vw;justify-content:center}"]})};export{$ as BookRideComponent};
